partitioned_time_elapsed = partitioned_time_elapsed,
time_elapsed_difference = time_elapsed_difference
))
}
## 5. Make a scatter plot of how much faster the code runs for partitioned data
## (e.g. 2x faster, 3x faster) vs. the size of filtered data
df_time_elapsed <- unique(combined_partitioned %>% pull(state)) %>%
lapply(function(state_name) {
each_results <- time_elapsed(state_name)
filtered_size <- combined_partitioned %>%
filter(state == state_name) %>%
nrow()
non_partitioned_time <- as.numeric(each_results$non_partitioned_time_elapsed, units = "secs")
partitioned_time <- as.numeric(each_results$partitioned_time_elapsed, units = "secs")
data.frame(
state = state_name,
filtered_size = filtered_size,
non_partitioned_time = non_partitioned_time,
partitioned_time = partitioned_time,
speed_improvement = non_partitioned_time / partitioned_time
)
}) %>%
bind_rows()
scatter_plot_speed_improvement_by_size <- df_time_elapsed %>%
ggplot(aes(x = filtered_size, y = speed_improvement)) +
geom_point() +
labs(
x = "Filtered Data Size for Each State",
y = "Speed Improvement (Non-Partitioned / Partitioned)",
title = "Speed Improvement vs. Filtered Data Size"
) +
theme_minimal()
ggsave("scatter_plot_speed_improvement_by_size.png", path = getwd(), scatter_plot_speed_improvement_by_size)
## 6. Create a new plot with 3 data series:
## the y-axis includes the total time without partitioning,
## total time elapsed with partitioning
## and the difference in time between the two.
df_time_elapsed <- df_time_elapsed %>%
mutate(time_difference = non_partitioned_time - partitioned_time)
plot_time_comparision_by_size <- df_time_elapsed %>%
ggplot(aes(x = filtered_size)) +
geom_line(aes(y = non_partitioned_time, color = "Non-Partitioned Time"), size = 1) +
geom_line(aes(y = partitioned_time, color = "Partitioned Time"), size = 1) +
geom_line(aes(y = time_difference, color = "Time Difference"), size = 1) +
labs(
title = "Time Comparison by Filtered Data Size with 3 Data Series",
x = "Filtered Data Size (Number of Rows)",
y = "Time Elapsed (Seconds)",
color = "Metric"
) +
theme_minimal()
ggsave("plot_time_comparision_by_size.png", path = getwd(), plot_time_comparision_by_size)
getwd()
getwd()
setwd("/Users/yeong/Documents/GitHub/problem-set-4-chaeyeonguc")
getwd()
ggsave("scatter_plot_speed_improvement_by_size.png", path = getwd(), scatter_plot_speed_improvement_by_size)
plot_time_comparision_by_size <- df_time_elapsed %>%
ggplot(aes(x = filtered_size)) +
geom_line(aes(y = non_partitioned_time, color = "Non-Partitioned Time"), size = 1) +
geom_line(aes(y = partitioned_time, color = "Partitioned Time"), size = 1) +
geom_line(aes(y = time_difference, color = "Time Difference"), size = 1) +
labs(
title = "Time Comparison by Filtered Data Size with 3 Data Series",
x = "Filtered Data Size (Number of Rows)",
y = "Time Elapsed (Seconds)",
color = "Metric"
) +
theme_minimal()
ggsave("plot_time_comparision_by_size.png", path = getwd(), plot_time_comparision_by_size)
style_file("/Users/yeong/Documents/GitHub/problem-set-4-chaeyeonguc/DAP_4.R")
# Creating a plot by poverty headcount ratio
inclusive_poverty_gdp_long <- inclusive_poverty_gdp %>%
pivot_longer(
cols = starts_with("per_"),
names_to = "financial_inclusion_metric",
values_to = "percentage"
) %>%
mutate(financial_inclusion_metric = case_when(
financial_inclusion_metric == "per_account_ownership_poor" ~ "Account Ownership",
financial_inclusion_metric == "per_saving_poor" ~ "Saving",
financial_inclusion_metric == "per_borrowing_poor" ~ "Borrowing",
financial_inclusion_metric == "per_digital_payment_poor" ~ "Digital Payment",
TRUE ~ financial_inclusion_metric
))
# Plot correlation with year as shape
correlation_plot <- ggplot(inclusive_poverty_gdp_long, aes(x = percentage, y = poverty_headcount_ratio, color = income_group, shape = factor(year))) +
geom_point(alpha = 0.7, size = 3) +
geom_smooth(method = "lm", se = FALSE, linetype = "dashed") +
facet_wrap(~financial_inclusion_metric, scales = "free", ncol = 2) +
labs(
title = "Correlation Between Financial Inclusion and Poverty Ratio Over Years",
x = "Financial Inclusion Metrics (%)",
y = "Poverty Headcount Ratio (%)",
color = "Income Group",
shape = "Year"
) +
theme_minimal()
# Display the plot
print(correlation_plot)
# Plot correlation with year as shape
correlation_plot <- ggplot(inclusive_poverty_gdp_long, aes(x = percentage, y = poverty_headcount_ratio, color = income group, shape = factor(year))) +
inclusive_poverty_gdp_long
# Plot correlation with year as shape
correlation_plot <- ggplot(inclusive_poverty_gdp_long, aes(x = percentage, y = poverty_headcount_ratio, color = `income group`, shape = factor(year))) +
geom_point(alpha = 0.7, size = 3) +
geom_smooth(method = "lm", se = FALSE, linetype = "dashed") +
facet_wrap(~financial_inclusion_metric, scales = "free", ncol = 2) +
labs(
title = "Correlation Between Financial Inclusion and Poverty Ratio Over Years",
x = "Financial Inclusion Metrics (%)",
y = "Poverty Headcount Ratio (%)",
color = "Income Group",
shape = "Year"
) +
theme_minimal()
# Display the plot
print(correlation_plot)
# Plot access to financial services for the poor
financial_plot <- ggplot(data_long, aes(x = year, y = percentage, color = metric, group = metric)) +
geom_line(size = 1) +
facet_wrap(~income_group, scales = "free_y") +
labs(
title = "Gap in Access to Financial Services for the Poor by Income Group",
x = "Year",
y = "Percentage (%)",
color = "Financial Service"
) +
theme_minimal()
# Plot access to financial services for the poor
financial_plot <- ggplot(inclusive_poverty_gdp_long, aes(x = year, y = percentage, color = metric, group = metric)) +
geom_line(size = 1) +
facet_wrap(~`income group`, scales = "free_y") +
labs(
title = "Gap in Access to Financial Services for the Poor by Income Group",
x = "Year",
y = "Percentage (%)",
color = "Financial Service"
) +
theme_minimal()
# Plot poverty rates
poverty_plot <- ggplot(inclusive_poverty_gdp, aes(x = year, y = poverty_headcount_ratio, color = `income group`, group = `income group`)) +
geom_line(size = 1) +
labs(
title = "Poverty Rates by Income Group",
x = "Year",
y = "Poverty Headcount Ratio (%)",
color = "Income Group"
) +
theme_minimal()
# Display both plots
print(financial_plot)
# Plot access to financial services for the poor
financial_plot <- ggplot(inclusive_poverty_gdp_long, aes(x = year, y = percentage, color = financial_inclusion_metric, group = financial_inclusion_metric)) +
geom_line(size = 1) +
facet_wrap(~`income group`, scales = "free_y") +
labs(
title = "Gap in Access to Financial Services for the Poor by Income Group",
x = "Year",
y = "Percentage (%)",
color = "Financial Service"
) +
theme_minimal()
# Display both plots
print(financial_plot)
print(poverty_plot)
# Display both plots
print(financial_plot)
colnames(inclusive_poverty_gdp)
# Creating a plot with 4 financial inclusion indicators for the poor by poverty headcount ratio
plot_financial_inclusion_by_poverty <- inclusive_poverty_gdp %>%
ggplot(aes(x = poverty_headcount_ratio)) +
geom_line(aes(y = per_account_ownership_poor, color = "Account Ownership"), size = 1) +
geom_line(aes(y = per_saving_poor, color = "Saving"), size = 1) +
geom_line(aes(y = per_borrowing_poor, color = "Borrowing"), size = 1) +
geom_line(aes(y = per_digital_payment_poor, color = "Digital Payment"), size = 1) +
labs(
title = "Financial Inclusion for poorest 40% by Poverty Headcount Ratio with 3 Data Series",
x = "Poverty Headcount Ratio",
y = "Financial Inclusion for poorest 40% (% ages 15+)",
color = "Metric"
) +
theme_minimal()
print(plot_financial_inclusion_by_poverty)
# Creating a plot with 4 financial inclusion indicators for the poor by poverty headcount ratio
plot_financial_inclusion_by_poverty <- inclusive_poverty_gdp %>%
ggplot(aes(x = poverty_headcount_ratio)) +
geom_line(aes(y = per_account_ownership_poor, color = "Account Ownership"), size = 1) +
geom_line(aes(y = per_saving_poor, color = "Saving"), size = 1) +
geom_line(aes(y = per_borrowing_poor, color = "Borrowing"), size = 1) +
geom_line(aes(y = per_digital_payment_poor, color = "Digital Payment"), size = 1) +
facet_wrap(~income group`) +
# Creating a plot with 4 financial inclusion indicators for the poor by poverty headcount ratio
plot_financial_inclusion_by_poverty <- inclusive_poverty_gdp %>%
ggplot(aes(x = poverty_headcount_ratio)) +
geom_line(aes(y = per_account_ownership_poor, color = "Account Ownership"), size = 1) +
geom_line(aes(y = per_saving_poor, color = "Saving"), size = 1) +
geom_line(aes(y = per_borrowing_poor, color = "Borrowing"), size = 1) +
geom_line(aes(y = per_digital_payment_poor, color = "Digital Payment"), size = 1) +
facet_wrap(~`income group`) +
labs(
title = "Financial Inclusion for poorest 40% by Poverty Headcount Ratio with 3 Data Series",
x = "Poverty Headcount Ratio",
y = "Financial Inclusion for poorest 40% (% ages 15+)",
color = "Metric"
) +
theme_minimal()
print(plot_financial_inclusion_by_poverty)
# Creating a plot with 4 financial inclusion indicators for the poor by poverty headcount ratio
plot_financial_inclusion_by_poverty <- inclusive_poverty_gdp %>%
ggplot(aes(x = poverty_headcount_ratio)) +
geom_line(aes(y = per_account_ownership_poor, color = "Account Ownership"), size = 1) +
geom_line(aes(y = per_saving_poor, color = "Saving"), size = 1) +
geom_line(aes(y = per_borrowing_poor, color = "Borrowing"), size = 1) +
geom_line(aes(y = per_digital_payment_poor, color = "Digital Payment"), size = 1) +
facet_wrap(~year) +
labs(
title = "Financial Inclusion for poorest 40% by Poverty Headcount Ratio with 3 Data Series",
x = "Poverty Headcount Ratio",
y = "Financial Inclusion for poorest 40% (% ages 15+)",
color = "Metric"
) +
theme_minimal()
print(plot_financial_inclusion_by_poverty)
inclusive_poverty_gdp <- inclusive_poverty_gdp %>%
mutate(poverty_bins = cut(poverty_headcount_ratio, breaks = seq(0, 50, by = 10), include.lowest = TRUE))
# Creating a plot with 4 financial inclusion indicators for the poor by poverty headcount ratio
plot_financial_inclusion_by_poverty <- inclusive_poverty_gdp %>%
ggplot(aes(x = poverty_bins)) +
geom_line(aes(y = per_account_ownership_poor, color = "Account Ownership"), size = 1) +
geom_line(aes(y = per_saving_poor, color = "Saving"), size = 1) +
geom_line(aes(y = per_borrowing_poor, color = "Borrowing"), size = 1) +
geom_line(aes(y = per_digital_payment_poor, color = "Digital Payment"), size = 1) +
facet_wrap(~year) +
labs(
title = "Financial Inclusion for poorest 40% by Poverty Headcount Ratio with 3 Data Series",
x = "Poverty Headcount Ratio",
y = "Financial Inclusion for poorest 40% (% ages 15+)",
color = "Metric"
) +
theme_minimal()
print(plot_financial_inclusion_by_poverty)
ggplot(inclusive_poverty_gdp, aes(x = poverty_headcount_ratio, y = year, fill = per_account_ownership_poor)) +
geom_density_ridges_gradient(scale = 2) +
labs(
title = "Density of Financial Inclusion Metrics by Year",
x = "Poverty Headcount Ratio",
y = "Year",
fill = "Account Ownership (%)"
) +
theme_minimal()
library(ggridges)
ggplot(inclusive_poverty_gdp, aes(x = poverty_headcount_ratio, y = year, fill = per_account_ownership_poor)) +
geom_density_ridges_gradient(scale = 2) +
labs(
title = "Density of Financial Inclusion Metrics by Year",
x = "Poverty Headcount Ratio",
y = "Year",
fill = "Account Ownership (%)"
) +
theme_minimal()
# Creating a plot with 4 financial inclusion indicators for the poor by poverty headcount ratio
plot_financial_inclusion_by_poverty <- inclusive_poverty_gdp %>%
ggplot(aes(x = poverty_headcount_ratio)) +
geom_line(aes(y = per_account_ownership_poor, color = "Account Ownership"), size = 1) +
geom_line(aes(y = per_saving_poor, color = "Saving"), size = 1) +
geom_line(aes(y = per_borrowing_poor, color = "Borrowing"), size = 1) +
geom_line(aes(y = per_digital_payment_poor, color = "Digital Payment"), size = 1) +
facet_wrap(~year) +
labs(
title = "Financial Inclusion for poorest 40% by Poverty Headcount Ratio with 3 Data Series",
x = "Poverty Headcount Ratio",
y = "Financial Inclusion for poorest 40% (% ages 15+)",
color = "Metric"
) +
theme_minimal()
print(plot_financial_inclusion_by_poverty)
# Creating a plot with 4 financial inclusion indicators for the poor by poverty headcount ratio
plot_financial_inclusion_by_poverty <- inclusive_poverty_gdp %>%
ggplot(aes(x = poverty_headcount_ratio)) +
geom_boxplot(aes(y = per_account_ownership_poor, color = "Account Ownership"), size = 1) +
geom_boxplot(aes(y = per_saving_poor, color = "Saving"), size = 1) +
geom_boxplot(aes(y = per_borrowing_poor, color = "Borrowing"), size = 1) +
geom_boxplot(aes(y = per_digital_payment_poor, color = "Digital Payment"), size = 1) +
facet_wrap(~year) +
labs(
title = "Financial Inclusion for poorest 40% by Poverty Headcount Ratio with 3 Data Series",
x = "Poverty Headcount Ratio",
y = "Financial Inclusion for poorest 40% (% ages 15+)",
color = "Metric"
) +
theme_minimal()
print(plot_financial_inclusion_by_poverty)
# Creating a plot with 4 financial inclusion indicators for the poor by poverty headcount ratio
plot_financial_inclusion_by_poverty <- inclusive_poverty_gdp %>%
ggplot(aes(x = poverty_headcount_ratio)) +
geom_point(aes(y = per_account_ownership_poor, color = "Account Ownership"), size = 1) +
geom_point(aes(y = per_saving_poor, color = "Saving"), size = 1) +
geom_point(aes(y = per_borrowing_poor, color = "Borrowing"), size = 1) +
geom_point(aes(y = per_digital_payment_poor, color = "Digital Payment"), size = 1) +
facet_wrap(~year) +
labs(
title = "Financial Inclusion for poorest 40% by Poverty Headcount Ratio with 3 Data Series",
x = "Poverty Headcount Ratio",
y = "Financial Inclusion for poorest 40% (% ages 15+)",
color = "Metric"
) +
theme_minimal()
print(plot_financial_inclusion_by_poverty)
# Creating a plot with 4 financial inclusion indicators for the poor by poverty headcount ratio
plot_financial_inclusion_by_poverty <- inclusive_poverty_gdp %>%
ggplot(aes(x = poverty_headcount_ratio)) +
geom_point(aes(y = per_account_ownership_poor, color = "Account Ownership"), size = 1) +
geom_point(aes(y = per_saving_poor, color = "Saving"), size = 1) +
geom_point(aes(y = per_borrowing_poor, color = "Borrowing"), size = 1) +
geom_point(aes(y = per_digital_payment_poor, color = "Digital Payment"), size = 1) +
labs(
title = "Financial Inclusion for poorest 40% by Poverty Headcount Ratio with 3 Data Series",
x = "Poverty Headcount Ratio",
y = "Financial Inclusion for poorest 40% (% ages 15+)",
color = "Metric"
) +
theme_minimal()
print(plot_financial_inclusion_by_poverty)
# Creating a plot with 4 financial inclusion indicators for the poor by poverty headcount ratio in general
plot_financial_inclusion_by_poverty <- inclusive_poverty_gdp %>%
ggplot(aes(x = poverty_headcount_ratio)) +
geom_point(aes(y = per_account_ownership_poor, color = "Account Ownership"), size = 1) +
geom_point(aes(y = per_saving_poor, color = "Saving"), size = 1) +
geom_point(aes(y = per_borrowing_poor, color = "Borrowing"), size = 1) +
geom_point(aes(y = per_digital_payment_poor, color = "Digital Payment"), size = 1) +
labs(
title = "Financial Inclusion for poorest 40% by Poverty Headcount Ratio",
x = "Poverty Headcount Ratio",
y = "Financial Inclusion for poorest 40% (% ages 15+)",
color = "Metric"
) +
theme_minimal()
print(plot_financial_inclusion_by_poverty)
# Creating a plot with 4 financial inclusion indicators for the poor by poverty headcount ratio in general
plot_financial_inclusion_by_poverty <- inclusive_poverty_gdp %>%
ggplot(aes(x = poverty_headcount_ratio)) +
geom_pointrange(aes(y = per_account_ownership_poor, color = "Account Ownership"), size = 1) +
geom_pointrange(aes(y = per_saving_poor, color = "Saving"), size = 1) +
geom_pointrange(aes(y = per_borrowing_poor, color = "Borrowing"), size = 1) +
geom_pointrange(aes(y = per_digital_payment_poor, color = "Digital Payment"), size = 1) +
labs(
title = "Financial Inclusion for poorest 40% by Poverty Headcount Ratio",
x = "Poverty Headcount Ratio",
y = "Financial Inclusion for poorest 40% (% ages 15+)",
color = "Metric"
) +
theme_minimal()
print(plot_financial_inclusion_by_poverty)
# Creating a plot with 4 financial inclusion indicators for the poor by poverty headcount ratio
plot_financial_inclusion_by_poverty <- inclusive_poverty_gdp %>%
ggplot(aes(x = poverty_headcount_ratio)) +
geom_point(aes(y = per_account_ownership_poor, color = "Account Ownership"), size = 1) +
geom_point(aes(y = per_saving_poor, color = "Saving"), size = 1) +
geom_point(aes(y = per_borrowing_poor, color = "Borrowing"), size = 1) +
geom_point(aes(y = per_digital_payment_poor, color = "Digital Payment"), size = 1) +
facet_wrap(~year) +
labs(
title = "Financial Inclusion for poorest 40% by Poverty Headcount Ratio across Years",
x = "Poverty Headcount Ratio",
y = "Financial Inclusion for poorest 40% (% ages 15+)",
color = "Metric"
) +
theme_minimal()
print(plot_financial_inclusion_by_poverty)
# Creating a plot with 4 financial inclusion indicators for the poor by poverty headcount ratio
plot_financial_inclusion_by_poverty <- inclusive_poverty_gdp %>%
ggplot(aes(x = poverty_headcount_ratio, group = year)) +
geom_line(aes(y = per_account_ownership_poor, color = "Account Ownership", linetype = as.factor(year)), size = 1) +
geom_line(aes(y = per_saving_poor, color = "Saving", linetype = as.factor(year)), size = 1) +
geom_line(aes(y = per_borrowing_poor, color = "Borrowing", linetype = as.factor(year)), size = 1) +
geom_line(aes(y = per_digital_payment_poor, color = "Digital Payment", linetype = as.factor(year)), size = 1) +
labs(
title = "Financial Inclusion for Poorest 40% by Poverty Headcount Ratio",
x = "Poverty Headcount Ratio",
y = "Financial Inclusion for Poorest 40% (% ages 15+)",
color = "Metric",
linetype = "Year"
) +
theme_minimal()
print(plot_financial_inclusion_by_poverty)
# Creating a plot with 4 financial inclusion indicators for the poor by poverty headcount ratio
plot_financial_inclusion_by_poverty <- inclusive_poverty_gdp %>%
pivot_longer(cols = starts_with("per_"), names_to = "Metric", values_to = "Value") %>%
ggplot(aes(x = poverty_headcount_ratio, y = Value, color = Metric)) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
facet_wrap(~ year) +
labs(
title = "Trends in Financial Inclusion vs Poverty",
x = "Poverty Headcount Ratio",
y = "Financial Inclusion (% ages 15+)",
color = "Metric"
) +
theme_minimal()
print(plot_financial_inclusion_by_poverty)
# Creating a plot with 4 financial inclusion indicators for the poor by poverty headcount ratio
inclusive_poverty_gdp_long <- inclusive_poverty_gdp %>%
pivot_longer(cols = starts_with("per_"), names_to = "Metric", values_to = "Value")
inclusive_poverty_gdp_long
inclusive_poverty_gdp <- read_csv("data/inclusive_poverty_gdp.csv")
setwd("/Users/yeong/Documents/GitHub/R-II_final")
inclusive_poverty_gdp <- read_csv("data/inclusive_poverty_gdp.csv")
colnames(inclusive_poverty_gdp)
# Creating a plot with 4 financial inclusion indicators for the poor by poverty headcount ratio
inclusive_poverty_gdp_long <- inclusive_poverty_gdp %>%
pivot_longer(cols = starts_with("per_"), names_to = "Metric", values_to = "Value")
inclusive_poverty_gdp_long
view(inclusive_poverty_gdp_long)
plot_financial_inclusion_by_poverty <- inclusive_poverty_gdp_long %>%
ggplot(aes(x = poverty_headcount_ratio, y = Value, color = metric)) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
facet_wrap(~ year) +
labs(
title = "Trends in Financial Inclusion vs Poverty",
x = "Poverty Headcount Ratio",
y = "Financial Inclusion for income, poorest 40% (% ages 15+)",
color = "Metric"
) +
theme_minimal()
print(plot_financial_inclusion_by_poverty)
# Creating a plot with 4 financial inclusion indicators for the poor by poverty headcount ratio
inclusive_poverty_gdp_long <- inclusive_poverty_gdp %>%
pivot_longer(cols = starts_with("per_"), names_to = "metric", values_to = "value")
plot_financial_inclusion_by_poverty <- inclusive_poverty_gdp_long %>%
ggplot(aes(x = poverty_headcount_ratio, y = value, color = metric)) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
facet_wrap(~ year) +
labs(
title = "Trends in Financial Inclusion vs Poverty",
x = "Poverty Headcount Ratio",
y = "Financial Inclusion for income, poorest 40% (% ages 15+)",
color = "Metric"
) +
theme_minimal()
print(plot_financial_inclusion_by_poverty)
plot_financial_inclusion_by_poverty <- inclusive_poverty_gdp_long %>%
ggplot(aes(x = poverty_headcount_ratio, y = value, color = metric)) +
geom_line(size = 1, alpha = 0.5) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
facet_wrap(~ year) +
labs(
title = "Trends in Financial Inclusion vs Poverty",
x = "Poverty Headcount Ratio",
y = "Financial Inclusion for income, poorest 40% (% ages 15+)",
color = "Metric"
) +
theme_minimal()
print(plot_financial_inclusion_by_poverty)
plot_financial_inclusion_by_poverty <- inclusive_poverty_gdp_long %>%
ggplot(aes(x = poverty_headcount_ratio, y = value, color = metric)) +
geom_line(size = 1, alpha = 0.5) +
facet_wrap(~ year) +
labs(
title = "Trends in Financial Inclusion vs Poverty",
x = "Poverty Headcount Ratio",
y = "Financial Inclusion for income, poorest 40% (% ages 15+)",
color = "Metric"
) +
theme_minimal()
print(plot_financial_inclusion_by_poverty)
plot_financial_inclusion_by_poverty <- inclusive_poverty_gdp_long %>%
ggplot(aes(x = poverty_headcount_ratio, y = value, color = metric)) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
facet_wrap(~ year) +
labs(
title = "Trends in Financial Inclusion vs Poverty",
x = "Poverty Headcount Ratio",
y = "Financial Inclusion for income, poorest 40% (% ages 15+)",
color = "Metric"
) +
theme_minimal()
plot_financial_inclusion_by_poverty <- inclusive_poverty_gdp_long %>%
ggplot(aes(x = poverty_headcount_ratio, y = value, color = metric)) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
facet_wrap(~ year) +
labs(
title = "Trends in Financial Inclusion vs Poverty across Years",
x = "Poverty Headcount Ratio",
y = "Financial Inclusion for income, poorest 40% (% ages 15+)",
color = "Metric"
) +
theme_minimal()
print(plot_financial_inclusion_by_poverty)
plot_financial_inclusion_by_poverty <- inclusive_poverty_gdp_long %>%
ggplot(aes(x = poverty_headcount_ratio, y = value, color = metric)) +
geom_line(size = 1, alpha = 0.5) +
facet_wrap(~ year) +
labs(
title = "Trends in Financial Inclusion vs Poverty across Years",
x = "Poverty Headcount Ratio",
y = "Financial Inclusion for income, poorest 40% (% ages 15+)",
color = "Metric"
) +
theme_minimal()
print(plot_financial_inclusion_by_poverty)
plot_financial_inclusion_by_poverty <- inclusive_poverty_gdp_long %>%
ggplot(aes(x = poverty_headcount_ratio, y = value, color = metric)) +
geom_smooth(method = "lm", se = FALSE, size = 1) +
facet_wrap(~ year) +
labs(
title = "Trends in Financial Inclusion vs Poverty across Years",
x = "Poverty Headcount Ratio",
y = "Financial Inclusion for income, poorest 40% (% ages 15+)",
color = "Metric"
) +
theme_minimal()
print(plot_financial_inclusion_by_poverty)
